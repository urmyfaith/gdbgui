//- This is .pug file, which generates html. It used to be name jade.
//- Try instant online conversion at http://www.html2jade.org/

html
head
    title gdbgui - gdb in a browser

    base(target='_blank')

    link(href='static/css/gdbgui.css?_=#{timetag_to_prevent_caching}', rel='stylesheet')
    link(href='static/vendor/css/bootstrap.min.css', rel='stylesheet')
    link(href='static/vendor/css/messenger.css', rel='stylesheet')
    link(href='static/vendor/css/awesomeplete.css', rel='stylesheet')
    link(href='static/vendor/css/w2ui-1.4.3.css', rel='stylesheet')

    script(type="text/javascript" src='static/vendor/js/jquery.min.js')
    script(type="text/javascript" src='static/vendor/js/jquery.flot-0.8.3.min.js')
    script(type="text/javascript" src='static/vendor/js/bootstrap.min.js')
    script(type="text/javascript" src='static/vendor/js/w2ui-1.4.3.min.js')
    script(type="text/javascript" src='static/vendor/js/messenger.min.js')
    script(type="text/javascript" src='static/vendor/js/lodash.min.js')
    script(type="text/javascript" src='static/vendor/js/moment.min.js')
    script(type="text/javascript" src='static/vendor/js/awesomeplete.min.js')
    script(type="text/javascript" src='static/vendor/js/socket.io-1.3.5.min.js')

body(style='margin: 0')
    //- the content of this will be replaced
    div#layout(style="width: 100%; height: 100%;")


    div#top
        //- binary selection
        form(role=form)
            div.input-group.input-group-sm
                span.input-group-btn
                    button.btn.btn-primary#set_target_app(type="button") Load This Binary and Args
                input.form-control#binary(type="text", placeholder="/path/to/target/executable -and -flags", list='past_binaries', style="font-family: courier")
                datalist#past_binaries

                div(style="display:table-cell; vertical-align: middle; width: 80px;")
                    span#gdbgui_settings_button.glyphicon.glyphicon-cog.pointer(style='padding-left: 15px', title='settings')

                    span#shutdown_gdbgui.glyphicon.glyphicon-off.pointer(style='padding-right: 10px; padding-left: 15px', title='shutdown gdbgui (kill gdbgui server and close this tab)')


    //- source code
    div#main(style='height: 100%;')
        div.flexrow
            //- displays source file path input, and dropdown
            input#source_file_input.form-control.dropdown-input(autocomplete='off', placeholder='Enter source file path to view, or load binary then populate and select from dropdown', style='flex:1')

            button.dropdown-btn(type="button")
                span.caret

        div.flexrow
            //- displays loaded file path and input to jump to line
            span#source_code_heading.lighttext(style="margin-right: 5px;") (no source code file loaded)
            button.btn.btn-xs.btn-default#refresh_cached_source_files(style='margin-left: 10px; height=25px; max-height: 25px;') reload
                span.glyphicon.glyphicon-refresh(style='margin-left: 6px;')


            //- input to jump to a line in the source code
            input#jump_to_line.form-control.dropdown-input(autocomplete='on', placeholder='jump to line', title='Enter line number, then press enter', style="width: 150px; height: 25px; margin-left: 10")

            label(style='margin-left: 10px; font-weight: normal;')
                input#checkbox_show_assembly(type='checkbox')
                ='disassemble'

        div#code_container.gdb_content_div(style='height: 100%; overflow: auto; padding-bottom: 100px;')
            table#code_table.code
                tr
                    td(style='font-family: arial; font-style: italic;') Source code will be displayed here when applicable

    //- stack, vars, memory, breakpoints, registers
    div#right
        div(style='position: fixed; background: #f5f6f7; z-index: 10; width: 1000%; margin-top: -5px; padding-top: 5px;')
            div.btn-group.btn-group(role="group", style='margin-bottom: 6px;')
                button.btn.btn-default#run_button(type='button', title='Start inferior program from the beginning')
                    span.glyphicon.glyphicon-repeat

                button.btn.btn-default#continue_button(type='button', title='Continue until breakpoint is hit or inferior program exits')
                    span.glyphicon.glyphicon-play

                button.btn.btn-default#next_button(type='button', title="Step over next function call")
                    span.glyphicon.glyphicon-step-forward

                button.btn.btn-default#step_button(type='button', title="Step into next function call")
                    span.glyphicon.glyphicon-arrow-down

                button.btn.btn-default#return_button(type='button', title='Step out of current function')
                    span.glyphicon.glyphicon-arrow-up

            div.btn-group.btn-group-xs(role="group")
                button.btn.btn-default#next_instruction_button(type='button', title="Next Instruction: Execute one machine instruction, stepping over function calls") NI

                button.btn.btn-default#step_instruction_button(type='button', title="Step Instruction: Execute one machine instruction, stepping into function calls") SI

                button.btn.btn-default#send_interrupt_button(type='button', title='Send interrupt signal (SIGINT) to inferior process') INT

            div(style='white-space: nowrap; height: 1.8em;')
                span#status GDB is waiting to run a command

        div(style='height: 60px;')
        div.no_padding
            div.titlebar.flex.visibility_toggler(data-visibility_target_selector_string="#threads", data-glyph_selector='#threads_glyph')
                span.glyphicon.glyphicon-chevron-down#threads_glyph(style='margin-right: 6px;')
                span.lighttext call stack
            div#threads.gdb_content_div

        div.no_padding
            div.titlebar.flex.visibility_toggler(data-visibility_target_selector_string="#locals_collapse_wrapper", data-glyph_selector='#locals_glyph')
                span.glyphicon.glyphicon-chevron-down#locals_glyph(style='margin-right: 6px;')
                span.lighttext locals
            div#locals_collapse_wrapper
                div#locals.gdb_content_div(style='margin-top: 6px;')

        div.no_padding
            div.titlebar.flex.visibility_toggler(data-visibility_target_selector_string="#expressions_collapse_wrapper", data-glyph_selector='#expressions_glyph')
                span.glyphicon.glyphicon-chevron-down#expressions_glyph(style='margin-right: 6px;')
                span.lighttext expressions
            div#expressions_collapse_wrapper
                input#expressions_input.form-control(placeholder='expression or variable', style="height:25px;")
                div#expressions.gdb_content_div(style='margin-top: 6px;')

        div.no_padding
            div.titlebar.flex.visibility_toggler(data-visibility_target_selector_string="#memory_collapse_wrapper", data-glyph_selector='#memory_glyph')
                span.glyphicon.glyphicon-chevron-down#memory_glyph(style='margin-right: 6px;')
                span.lighttext memory
            div#memory_collapse_wrapper
                input#memory_start_address(placeholder='start address (hex)', style="height:25px")
                input#memory_end_address(placeholder='end address (hex)', style="height:25px")
                input#memory_bytes_per_line(placeholder='bytes per line (dec)', style="height:25px;")
                div#memory.gdb_content_div(style='margin-top: 6px;')

        div.no_padding
            div.titlebar.visibility_toggler(data-visibility_target_selector_string="#breakpoints", data-glyph_selector='#breakpoints_glyph')
                span.glyphicon.glyphicon-chevron-down#breakpoints_glyph(style='margin-right: 6px;')
                span.lighttext breakpoints
            div#breakpoints.gdb_content_div

        div.no_padding
            div.titlebar.visibility_toggler(data-visibility_target_selector_string="#registers", data-glyph_selector='#registers_glyph')
                span.glyphicon.glyphicon-chevron-right#registers_glyph(style='margin-right: 6px;')
                span.lighttext registers
            div#registers.gdb_content_div.hidden

    //- gdb console
    div#bottom(style='margin-bottom: -5px;')

        //- gdb console output
        table(style='width:100%; height:100%; margin: 0; padding-bottom: 30px;')
            tr(style='height: 100%;')
                td
                    div#console.gdb_content_div(style='border-bottom: 0; border-bottom-left-radius: 0; border-bottom-right-radius: 0; height: 100%;')

        //- gdb console input
        table.gdb_command_input(style='width: 100%;')
            tr
                td(style='width: 30px; vertical-align: middle;')
                    span(style='margin-top: 10px') (gdb)
                td(style='width: 100%; float: left; vertical-align: middle;')
                     input.form-control.dropdown-input#gdb_command_input(type="text", autocomplete="on", data-list="#gdb_command_reference", placeholder='enter gdb command', style='float: left')
                td(style='width: 15px; vertical-align: middle; padding-right: 10px')
                    span.glyphicon.glyphicon-ban-circle.clear_console.pointer(title='clear console')


        //- gdb mi output
        if debug == 'true'
            p
            div
                div.titlebar
                    span.lighttext gdb machine interface output
                    button.btn.btn-default.clear_mi_output(type='button', title='Clear (clears ui element, does not send a gdb command)')
                            span.glyphicon.glyphicon-ban-circle
                div#gdb_mi_output.gdb_content_div


//- modal window, hidden by default
#gdb_modal.modal.fade(role='dialog')
    .modal-dialog
        .modal-content(style='padding: 20px;')
            #modal_header
                button.close(type='button', data-dismiss='modal') ×

            h4#modal_title Modal Header

            #modal_body(style='margin-top: 20px;')

            #modal_footer(style='margin-top: 20px;')
                button.btn.btn-success(type='button', data-dismiss='modal') Close


//- modal window, hidden by default
#gdb_settings_modal.modal.fade(role='dialog')
    .modal-dialog
        .modal-content(style='padding: 20px;')
            button.close(type='button', data-dismiss='modal') ×
            h4 Settings

            #settings_body

            div(style='margin-top: 20px;')
                button.btn.btn-success(type='button', data-dismiss='modal') Close

script.
    initial_data = JSON.parse('!{initial_data}')
    debug = JSON.parse('!{debug}')

script(type="text/javascript" src='static/js/gdbgui.js?_=#{timetag_to_prevent_caching}')
